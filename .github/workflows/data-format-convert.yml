name: ã€å“”å“©å“”å“©ã€‘éªŒè¯ UID æ ¼å¼å¹¶ä» JSON æ•°æ®ç”Ÿæˆå…¶ä»–æ ¼å¼

on:
  pull_request:
    branches:
      - main
    paths:
      - 'bilibili-normal.json'
  workflow_dispatch:

jobs:
  uid-check-and-data-format-convert:
    runs-on: ubuntu-latest

    steps:
    - name: æ£€å‡ºä»£ç 
      uses: actions/checkout@v3

    - name: è®¾ç½® Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.x'

    - name: å®‰è£…ä¾èµ–
      run: |
        python -m pip install --upgrade pip
        pip install PyYAML

    - name: æ£€æŸ¥ UID æ ¼å¼
      run: python bilibili_check_uid.py

    - name: è¿è¡Œè½¬æ¢è„šæœ¬
      run: python bilibili_convert_json.py

    - name: é…ç½® Git ä¿¡æ¯
      run: |
        git config --global user.name 'å®é™è‡´è¿œ'
        git config --global user.email '172552290+fjwxzde@users.noreply.github.com'

    - name: æäº¤è½¬æ¢ç»“æœ
      run: |
        git add "bilibili-normal-uids.txt" "bilibili-normal-usernames.txt" "bilibili-normal.md" "bilibili-normal.yaml"
        git commit -m "[è‡ªåŠ¨æµğŸ¤–]ã€å“”å“©å“”å“©ã€‘æ·»åŠ è½¬æ¢åçš„æ•°æ®"
